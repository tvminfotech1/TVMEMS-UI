<div class="banner">
  Your WFH Request Eligibility has been removed. Please reach
  <a href="mailto:wfm@sensiple.com">wfmsensiple.com</a> for more details.
</div>

<div class="apply-button">
  <button (click)="applyWfh()">➕ Apply Work From Home</button>
</div>

<app-wfh-apply-form
  *ngIf="showApplyForm"
  (formSubmitted)="onFormSubmitted()"
  (formCancelled)="onFormCancelled()"
></app-wfh-apply-form>

<div class="month-nav">
  <button (click)="prevMonth()">&#60;</button>
  <h2>📅 {{ getMonthName() }} {{ year }}</h2>
  <button (click)="nextMonth()">&#62;</button>
</div>

<div class="status-cards">
  <div class="card pending">
    <h3>Pending</h3>
    <p><span class="color">↑</span> {{ getCount('pending') }} / {{ totalRequests }}</p>
    <div class="percent">{{ getProgress('pending') }}%</div>
    <div class="progress-bar">
      <div class="progress pending" [style.width.%]="getProgress('pending')"></div>
    </div>
  </div>

  <div class="card approved">
    <h3>Approved</h3>
    <p><span>↑</span> {{ getCount('approved') }} / {{ totalRequests }}</p>
    <div class="percent">{{ getProgress('approved') }}%</div>
    <div class="progress-bar">
      <div class="progress approved" [style.width.%]="getProgress('approved')"></div>
    </div>
  </div>

  <div class="card rejected">
    <h3>Rejected</h3>
    <p><span class="red">↑</span> {{ getCount('rejected') }} / {{ totalRequests }}</p>
    <div class="percent">{{ getProgress('rejected') }}%</div>
    <div class="progress-bar">
      <div class="progress rejected" [style.width.%]="getProgress('rejected')"></div>
    </div>
  </div>
</div>

<div class="details-table">
  <div class="row header">
    <div>Employee Name</div>
    <div>Employee ID</div>
    <div>Date Range</div>
    <div>Days</div>
    <div>Reason</div>
    <div>Created At / Approver</div>
    <div>Status</div>
    <div *ngIf="isAdmin">Action</div>
  </div>

  <div class="row" *ngFor="let d of details">
    <div>{{ d.employeeName }}</div> <div>{{ d.employeeId }}</div>   <div>{{ d.fromDate }} - {{ d.toDate }}</div>
    <div>{{ d.days }}</div>
    <div>{{ d.reason }}</div>
    <div>{{ d.created }}<br />{{ d.approver }}</div>
    <div [ngClass]="{
          'approved-status': d.status === 'approved',
          'rejected-status': d.status === 'rejected',
          'pending-status': d.status === 'pending'
        }">
      {{ d.status | titlecase }}
    </div>
    <div *ngIf="isAdmin">
      <button (click)="updateStatus(d, 'approved')">✔️</button>
      <button (click)="updateStatus(d, 'rejected')">❌</button>
      <button (click)="updateStatus(d, 'pending')">🕒</button>
    </div>
  </div>
</div>